{% extends "base.html" %}

{% block title %}Lawyer Up - Nyay Mitra{% endblock %}

{% block extra_css %}
<style>
    .chat-container {
        max-width: 900px;
        margin: 0 auto;
    }
    
    .chat-header {
        text-align: center;
        margin-bottom: 30px;
    }
    
    .chat-header h2 {
        color: #1e3c72;
        margin-bottom: 10px;
    }
    
    .chat-header p {
        color: #666;
    }
    
    .chat-box {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 20px;
        min-height: 400px;
        max-height: 500px;
        overflow-y: auto;
        margin-bottom: 20px;
        box-shadow: inset 0 2px 10px rgba(0,0,0,0.05);
    }
    
    .chat-message {
        margin-bottom: 15px;
        padding: 12px 16px;
        border-radius: 8px;
        max-width: 80%;
        word-wrap: break-word;
        display: block;
        clear: both;
    }
    
    .user-message {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        margin-left: auto;
        text-align: right;
        float: right;
    }
    
    .bot-message {
        background: white;
        color: #333;
        margin-right: auto;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        float: left;
    }
    
    .message-label {
        font-size: 12px;
        font-weight: 600;
        margin-bottom: 5px;
        opacity: 0.8;
    }
    
    .message-text {
        line-height: 1.6;
        white-space: pre-wrap;
    }
    
    .chat-input-form {
        display: flex;
        gap: 10px;
        align-items: flex-end;
    }
    
    .chat-input-form textarea {
        flex: 1;
        min-height: 60px;
        max-height: 120px;
        resize: vertical;
        font-family: inherit;
    }
    
    .chat-input-form button {
        white-space: nowrap;
        height: fit-content;
    }
    
    .empty-chat {
        text-align: center;
        color: #999;
        padding: 50px 20px;
    }
    
    .back-link {
        text-align: center;
        margin-top: 20px;
    }
    
    .back-link a {
        color: #667eea;
        text-decoration: none;
        font-weight: 500;
    }
    
    .back-link a:hover {
        text-decoration: underline;
    }
    
    .clearfix::after {
        content: "";
        display: table;
        clear: both;
    }
</style>
{% endblock %}

{% block content %}
<div class="chat-container">
    <div class="chat-header">
        <h2>‚öñÔ∏è Lawyer Up - Nyay Mitra</h2>
        <p>Ask any legal questions and get AI-powered answers</p>
    </div>
    
    <div class="chat-box" id="chatBox">
        {% if chat_history and chat_history|length > 0 %}
            {% for message in chat_history %}
                <div class="clearfix">
                    <div class="chat-message {{ 'user-message' if message.role == 'user' else 'bot-message' }}">
                        <div class="message-label">{{ 'You' if message.role == 'user' else 'Nyay Mitra' }}</div>
                        <div class="message-text">{{ message.content }}</div>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <div class="empty-chat">
                <span style="font-size: 48px;">üí¨</span>
                <p>No messages yet. Start a conversation with your legal AI assistant!</p>
            </div>
        {% endif %}
    </div>
    
    <form class="chat-input-form" method="POST" action="{{ url_for('lawyer_up') }}" id="chatForm">
        <textarea 
            name="user_input" 
            id="userInput"
            placeholder="Type your legal question here..." 
            required
            rows="3"></textarea>
        <button type="submit" class="btn">Send üì§</button>
    </form>
    
    <div class="back-link">
        <a href="{{ url_for('index') }}">‚Üê Back to Home</a>
    </div>
</div>

<script>
    document.getElementById('chatForm').addEventListener('submit', function(e) {
        const userInput = document.getElementById('userInput').value.trim();
        if (userInput) {
            showLoading('Nyay Mitra is thinking...', 'Searching legal databases and generating response');
        } else {
            e.preventDefault();
        }
    });
    
    // Auto-scroll to bottom of chat
    window.addEventListener('DOMContentLoaded', function() {
        const chatBox = document.getElementById('chatBox');
        chatBox.scrollTop = chatBox.scrollHeight;
    });
</script>
{% endblock %}
